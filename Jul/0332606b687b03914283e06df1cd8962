Sir Kim Darroch, the UK ambassador to Washington who has been at the centre of a diplomatic row over leaked cables criticising Donald Trump, has resigned. The Guardian understands he concluded his position was untenable after watching the Conservative leadership debate on Tuesday, in which the frontrunner, Boris Johnson, stopped short of backing him. In a letter to Simon McDonald, the most senior official at the Foreign Office, Darroch said the row, in which Trump called the ambassador “a pompous fool” and “very stupid”, meant he could not continue. “Since the leak of official documents from this embassy, there has been a great deal of speculation surrounding my position and the duration of my remaining term as ambassador,” he wrote. “I want to put an end to that speculation. The current situation is making it impossible for me to carry out my role as I would like.” Replying to the letter, McDonald said Darroch had been the target of “a malicious leak” and expressed gratitude for his work. “You are the best of us,” McDonald said. The announcement came immediately before prime minister’s questions. No 10 said Theresa May had spoken to Darroch directly for about five minutes at about 11.30am. By this time, he had already spoken to McDonald. May told the House of Commons she had told Darroch it was “a matter of great regret that he has felt it necessary to leave his position”. She added: “Sir Kim has given a lifetime of service to the United Kingdom and we owe him an enormous debt of gratitude. Good government depends on public servants being able to give full and frank advice. I want all our public servants to have the confidence to be able to do that.” In language that will be viewed as an implicit criticism of Johnson’s failure to back Darroch, May said: “I hope the house will reflect on the importance of defending our values and principles, particularly when they are under pressure.” Jeremy Corbyn called the treatment of Darroch “beyond unfair and wrong” and said he had given “honourable and good service”. The Labour leader added: “The whole house should join together in deeply regretting the feeling he’s got that he must resign at this moment.” Darroch’s decision will put pressure on Johnson, who was criticised by some Conservatives after the leadership debate for refusing to give Darroch his support even as his rival, Jeremy Hunt, said he would expect the ambassador to stay in post until his planned retirement. When pressed on the point, Johnson gave only mild criticism of Trump and said a good relationship with the US was “of fantastic importance”. Sir Alan Duncan, a Foreign Office minister, said Johnson had thrown Darroch “under the bus to serve his own personal interests” and accused him of “contemptible negligence”. Duncan told the BBC: “I’m upset and angry. And there are a lot of people here in the Commons who are very, very angry and feel he has lost so much respect for having done what he’s done. His disregard for Sir Kim Darroch and his refusal to back him was in my view pretty contemptible, but also not in the interests of the country he’s trying to lead.” There is now speculation about when the new ambassador will be appointed, particularly whether the decision will be made before May leaves office in just over two weeks. Her spokesman said only that the choice would be made “in due course”. Hunt, the foreign secretary, said in a statement on Wednesday that he was “deeply saddened” by the outcome, adding: “Whenever I visited Washington as foreign secretary, I was struck by Sir Kim’s professionalism and intellect. I am outraged that a selection of his reports should have been leaked.” In the confidential memos, leaked to a newspaper at the weekend, Darroch said Trump’s administration was seen as “incompetent”, “inept” and “insecure”. Such robust assessments are routine in secure diplomatic communications, but Trump responded with fury in a series of tweets. A day after Trump said he would no longer deal with Darroch, he used his Twitter feed to attack the diplomat, saying: “The wacky ambassador that the UK foisted upon the United States is not someone we are thrilled with, a very stupid guy.” The controversy escalated further as Hunt responded by calling the president’s language “disrespectful and wrong”. In his letter to McDonald, Darroch wrote: “Although my posting is not due to end until the end of this year, I believe in the current circumstances the responsible course is to allow the appointment of a new ambassador. “I am grateful to all those in the UK and the US who have offered their support during this difficult few days. This has brought home to me the depth of friendship and close ties between our two countries. I have been deeply touched. “I am also grateful to all those with whom I have worked over the last four decades, particularly my team here in the US. The professionalism and integrity of the British civil service is the envy of the world. I will leave it full of confidence that its values remain in safe hands.” McDonald wrote that he accepted the resignation “with deep personal regret”. He added: “Over the last few difficult days, you have behaved as you have always behaved over a long and distinguished career – with dignity, professionalism and class. The prime minister, foreign secretary and whole of the public service have stood with you: you were the target of a malicious leak; you were simply doing your job. “I understand your wish to relieve the pressure on your family and your colleagues at the embassy; I admire the fact that you think more of others than yourself. You demonstrate the essence of the values of British public service.”