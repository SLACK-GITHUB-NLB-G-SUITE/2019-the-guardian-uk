Madagascar pulled off one of the great shocks of the Africa Cup of Nations finals when they upset Nigeria 2-0 on Sunday to finish top of Group B and advance to the knockout stages. A horrific defensive mistake and a wicked deflection from a free-kick allowed the Indian Ocean islanders, making their tournament debut, to finish unbeaten ahead of both Nigeria and Guinea in the standings. Lalaïna Nomenjanahary took advantage of sloppy defending by Leon Balogun to open the scoring in the 13th minute and Carolus Andriamahitsinoro netted the second eight minutes into the second half. Nigeria, one of the five African teams at last year’s World Cup, had won their opening two matches but looked flat and proved unable to respond after going behind in their third and face extensive soul-searching after an embarrassing setback. Nomenjanahary reacted quickly to intercept a pass back from John Ogu to Balogun, who inexplicably backed away from the ball on the edge of the Nigeria penalty area, almost inviting the Malagasy striker to steal it away. The early goal injected some confidence into the Malagasy, a motley collection of players from the lower leagues in France as well as clubs in Belgium, Bulgaria and the United States, but they rode their luck towards the end of the first half as Nigeria sought an equaliser. Ahmed Musa had the best chance for the Super Eagles, unmarked for a first-time finish at the back post in the 31st minute, but he took a touch, giving the Madagascar goalkeeper, Melvin Adrien, the opportunity to close him down and put him off his shot. Adrien might have conceded a penalty with his challenge but Nigeria’s protests were waved away by the referee, Bakary Gassama of the Gambia. Nigeria brought on Wilfred Ndidi to try to inspire a second-half comeback but he was culpable for the second goal. First he gave away a free-kick on the edge of the area and then, as he jumped in the wall, deflected the 53rd-minute effort from Andriamahitsinoro. The ball took a wicked loop off Ndidi’s body before falling into the net. Ndidi did try to make amends and had a good turn and shot saved soon afterwards but was unable to give his side the necessary spark. Oghenekaro Etebo went wide with two free-kicks and even the introduction of Alex Iwobi for the last 30 minutes did little to change the course of the game. Madagascar, ranked 108th in world football, finished on seven points to six for second-placed Nigeria. Guinea’s four points in third place should be enough to see them also advance to the last 16 but Burundi, in last place without any points, are eliminated. Later, Mohamed Salah was on target as hosts Egypt ensured they emerged from Group A with a perfect record despite a stern examination by Uganda. Salah’s free-kick and a second goal from Aston Villa midfielder Ahmed Elmohamady before the break secured a 2-0 win. But the scoreline flattered them on a night when Sebastien Desabre’s side, who finished second in the group with four points and take their place in the last-16, more than gave as good as they got in Cairo. Egypt keeper Mohamed El-Shenawy had made a number of good saves before Salah curled a left-foot free-kick over the wall and past keeper Denis Onyango in the 36th minute. Elmohamady smashed home a second in first-half stoppage time to clinch a third successive victory for Egypt, all without conceding a goal. Salah almost made it 3-0 early in the second half, only to be denied Onyango, who is a doubt for the knockout phase after being stretchered off with 18 minutes remaining. Elsewhere, Mohamed Yattara scored both goals as Guinea defeated 10-man Burundi in Cairo. Yattara was the most influential player on the pitch as a foul on him led to an early red card for Burundi’s Christophe Nduwarugira, before he scored his two goals. Burundi have had a difficult introduction to continental finals, with the east African side losing all three games and departing goalless. Later on Sunday night Group A concludes with Uganda playing Egypt and Zimbabwe up against the Democratic Republic of Congo.