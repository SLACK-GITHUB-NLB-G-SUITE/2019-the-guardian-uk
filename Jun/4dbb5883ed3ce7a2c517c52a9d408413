Ordering airstrikes and then calling them off at the last minute is one way of working through the contradictions in your Middle East policy, but it is very expensive and highly dangerous way of going about it. Ever since Donald Trump took office and his conflicting impulses were applied to US foreign policy, a moment like this was all but inevitable. One of those impulses is to restore American “greatness” by acting tough, and – in particular – reversing every agreement Barack Obama had made with the rest of the world. Throughout his presidential campaign, Trump had portrayed Obama as a weak president who – in his desire to please foreigners – had failed to put America first. Trump’s other dominant impulse was to avoid the mistakes of all his predecessors by keeping the US out of costly and bloody wars in remote places, where the fighting ought to be done by local allies. He would bring the troops home, and “everything will work out”. The man who has called himself “a very stable genius” would undoubtedly agree with the F Scott Fitzgerald remark that it was the test of a first-rate intelligence to be able to hold two opposing ideas in mind at the same time and still retain the ability to function. But Fitzgerald never did foreign policy. In Trump’s mind, of course, there are no contradictions. From his point of view, his threats to rain “fire and fury” down on North Korea and destroy the regime with his “bigger and more powerful” nuclear button, led to Kim Jong-un bowing to pressure and coming to the negotiating table. Trump had got tough and brought peace. That is not how Kim saw it. As far as he was concerned, he had completed his dynasty’s mission of assembling an arsenal of nuclear missiles that guaranteed the regime’s survival. He was prepared to talk vaguely about the “denuclearization of the Korean peninsula” but he was never going to disarm. That was the assessment of the US intelligence agencies, but it was downplayed to maintain the fiction that Trump had brought peace where others had failed. But Trump’s constantly dueling impulses ultimately stalled the negotiations. Halfway through the second summit in Hanoi, he abruptly switched tactics, from a phased approach to demanding immediate and complete disarmament. Kim walked away and has issued threats ever since that he will lose patience, implying a resumption of nuclear and long-range missile testing. Trump is anxious for the paper to remain plastered on the cracks at least until his re-election campaign is over, but it is unlikely Kim will wait that long. The campaign represents his window of maximum leverage. The same contradictions in Trump’s Iran policy have collided even sooner. His initial overriding impulse on entering the White House was to destroy Obama’s flagship diplomatic achievement, the 2015 deal with Iran, by which Tehran accepted strict curbs on its nuclear programme in return for sanctions relief. Members of his administration who argued against him were replaced with more committed hawks, most importantly John Bolton as national security adviser and Mike Pompeo as secretary of state. They have driven a policy, with Trump’s approval, aimed at not just at withdrawing from the 2015 deal, but making it impossible for other countries, including European allies, to honour it. Bolton and Pompeo appeared to have convinced Trump that by strangling the Iranian economy, Tehran would bow to sweeping US demands and the president would emerge a much greater statesman than Obama or any predecessor. The last powerful voice of caution, James Mattis, stepped down as defence secretary in December, and so far there has been no permanent replacement. The current acting secretary, Patrick Shanahan, stepping down for personal reasons, appears to have had little sway. It is now the generals, more familiar than Bolton and Pompeo with the realities of combat, who are left to apply the brakes. By Trump’s account, it was a general who told him about the estimate of 150 dead from the planned US air strikes. In his tweets, Trump claims he received that news at the eleventh hour. That would be unusual, as casualty estimates are a routine part of all planning for military operations. Trump already seemed to be having second thoughts earlier on Thursday morning, when he talked to the press sitting alongside the Canadian prime minister, Justin Trudeau, and his conflicting urges appear to play themselves out in public, as he mused about the pros and cons of action. “I said I want to get out of these endless wars. I campaigned on that: I want to get out,” Trump said. But everything else Trump has done in relation to Iran, driven by his other impulses, has kept the US headed on a trajectory towards conflict. On this occasion he veered away with only minutes to spare. The next time his inner conflicts collide, we may not be so lucky.