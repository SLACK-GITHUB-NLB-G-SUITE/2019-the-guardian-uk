US and Taliban negotiators are close to an agreement that would reduce fighting and allow full peace talks among Afghans, a top US official said on Sunday, a day after insurgent forces stormed the strategic northern city of Kunduz. But only hours after Zalmay Khalilzad, the Afghan-born US diplomat overseeing negotiations for Washington, spoke the Taliban attacked a second Afghan city, Puli Khumri, the capital of Baghlan province, an official said. Khalilzad said he warned the Taliban during talks in Qatar that “violence like this must stop”. However, he appeared determined to continue with the deal that plans the withdrawal of 14,000 remaining US troops in exchange for Taliban guarantees that Afghanistan will not be used as a launch pad for global attacks. “We are at the threshold of an agreement that will reduce violence and open the door for Afghans to sit together to negotiate an honourable and sustainable peace and a unified, sovereign Afghanistan that does not threaten the United States, its allies or any other country,” he said in a Twitter post. We are at the threshold of an agreement that will reduce violence and open the door for Afghans to sit together to negotiate an honorable & sustainable peace and a unified, sovereign Afghanistan that does not threaten the United States, its allies, or any other country. The comment came a day after a major show of strength by hundreds of Taliban fighters who overran parts of Kunduz – a city they have twice come close to taking in recent years – setting off a day of gun battles and airstrikes to drive them back. Khalilzad gave no details of the deal, which is expected to see thousands of US troops withdrawn from Afghanistan in exchange for guarantees by the Taliban not to allow the country to be used as a base for militant attacks abroad. “We will now discuss these developments with our own leadership, while Zalmay Khalilzad is supposed to go to Kabul and inform the Afghan leadership about the decisions made in the peace talks,” a senior Taliban leader said. The agreement would not end the fighting between the Taliban and Afghan security forces, but would allow the start of “intra-Afghan” peace talks, expected to be held in the Norwegian capital of Oslo. However, it was not clear whether the Taliban would agree to talk directly with the western-backed government of president Ashraf Ghani, which they consider an illegitimate foreign-imposed regime. Some Taliban officials have said they would agree to talk to Afghan officials only in a private capacity, not as representatives of the state, and they remain opposed to presidential elections scheduled for 28 September. It was also unclear whether the agreement would cover the withdrawal of all 14,500 US troops or how long a pullout would take. More than 20,000 foreign troops are in the country, most serving as part of a Nato-led mission to train and assist Afghan forces. Thousands of US troops are also engaged in a separate counter-terrorism mission fighting militant groups such as Islamic State and al-Qaida. Suicide bombings and combat operations have continued throughout the talks and the fighting in Kunduz underlined how vulnerable large parts of Afghanistan are, where the Taliban control more territory than at any time since being overthrown by a US-led campaign in 2001. Taliban fighters, who control large parts of the surrounding countryside, stormed the city early on Saturday, and seized large areas, including a hospital, before Afghan security forces backed by airstrikes pushed them back.