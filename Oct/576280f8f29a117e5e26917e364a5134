It was nearly the end of the beginning of Brexit. Nearly, but not yet. More than 1,200 days after Britain voted to leave the European Union, Boris Johnson had a deal accepted (in principle) by the House of Commons – a victory that eluded Theresa May three times. In a dramatic half-hour at Westminster on Tuesday night, MPs voted in favour of the Brexit deal but rejected the prime minister’s shotgun timetable to pass the bill that would make it possible. At that moment it was clear the UK would not leave the EU on Johnson’s “do or die” date of 31 October with a deal. Time had run out. Parliament’s demand for scrutiny meant the EU had to give serious consideration to Johnson’s grudging request for a further Brexit delay, which dropped into the inbox of the EU council president, Donald Tusk, late last Saturday night. The EU decided to grant the extension but is yet to decide how long it should be. Neither the exasperated EU nor the prime minister can guarantee if or when parliament will give its final assent to the deal. This week’s fractious, often angry debate in the Commons was a prologue to the second act of Brexit and revealed there is no consensus on the future. Parliament was ready to vote Brexit means Brexit, but has not agreed what Brexit means. After a summer of brinkmanship and bad-tempered exchanges between Brussels and London, Boris Johnson struck a deal with the EU on 17 October. The prime minister made three key concessions. First, to solve the long-running dispute over the Irish border, he agreed to customs checks between Great Britain and Northern Ireland and an all-Ireland regulatory zone for goods. In other words, he agreed to a border in the Irish Sea, a line he said in 2018 he would not accept. Secondly, he dropped his insistence that the Conservative’s coalition partners, the Democratic Unionist party, should be able to veto those arrangements. The EU also gave way, by allowing the Northern Ireland assembly to vote to quit the economic arrangements by a simple majority, although no one expects it to do so. The original plan to create a temporary insurance policy to avoid a hard border mutated into a permanent arrangement separating Northern Ireland economically from Great Britain. The backstop became a full stop. The final piece of the jigsaw was the non-binding political declaration that charts a course for future relations between the EU and UK. Abandoning May’s hopes for close economic ties, the two sides will now work towards a looser free-trade agreement. The prime minister was not successful in trying to drop a link between a free-trade deal and commitments to maintain existing EU standards on workers’ rights and environmental standards. But these guarantees were moved from the legal text to the non-binding declaration and the UK will not seek to match any raising of EU standards. MPs convening in the Commons for the first Saturday sitting since the Falklands war had been expected to deliver a decisive verdict on Johnson’s deal. Instead, they asked for more time. A majority of MPs supported an amendment from the former Conservative minister Oliver Letwin designed to prevent an accidental no-deal before 31 October. The prime minister was forced to request an extension, obeying the law as the government had always said he would, despite a stream of off-record briefings that No 10 had a secret plan to evade extension. But Johnson sent the EU three letters, including an unsigned one requesting the extension and a second arguing against a delay. Europe reacted with exasperation that MPs had passed on the chance to make a choice. Meeting on a drizzly Sunday morning in Brussels, EU diplomats decided to press on with the EU’s own ratification. The extension letter was left in the inbox. By Tuesday, the EU’s hopes of quick resolution were dashed. The House of Commons voted to back Johnson’s deal by 30 votes but rejected the timetable that would have seen parliament consider the 115-page withdrawal agreement bill in just three days – an accelerated process described as “insulting” in the Commons and “absurd” by an EU diplomat. Even the Brexit secretary, Stephen Barclay, had not mastered all the details. He told MPs (wrongly) that there would be no customs declarations required to send goods from Northern Ireland to Great Britain. He later corrected himself. The EU’s wait-and-see policy could no longer hold. Tusk, an anglophile who hopes the UK will one day rejoin, recommended the EU accept the British request to extend Brexit until 31 January, as requested by the Commons. In sticking to parliament’s request, he hoped the EU could avoid accusations of siding with Brexiters (by offering a short extension) or remainers (by offering a longer one). By Wednesday, EU member states had unanimously accepted the prime minister’s request for an extension. While most were ready to support a delay until 31 January, France was holding up a decision. The French president, Emmanuel Macron, hopes that a shorter delay might force a decision at Westminster. It was Macron’s earlier insistence on forcing the pace that created the countdown to 31 October when the EU debated the second Brexit extension in April. The EU is likely to grant a Brexit extension while continuing to complain about the disruptive neighbour that won’t leave. But the next steps from Westminster are less sure. The prime minister could pass the withdrawal agreement bill within a few weeks, possibly days. The pro-EU former Conservative chancellor Ken Clarke said the prime minister needed only “a modest adjustment” of the timetable. But as Labour and the Conservatives have been unable to agree a revised timetable for the bill, it could take weeks, even months. As time passes, different factions could mobilise behind their preferred Brexit. Labour MPs will press for a customs union and stronger protection for workers and the environment. Hardline Eurosceptics have signalled they want more oversight over payments to the EU. As details emerge from dense legal text, the government’s fragile coalition of Eurosceptic “Spartans”, former Tories and 19 Labour MPs risks fracturing. It cannot be ruled out that the government could lose the majority for Johnson’s Brexit deal in the final vote. All three options are likely to be accompanied by a general election, with the prime minister urging MPs to agree to go to the polls on 12 December. Another EU referendum looks a remote possibility but cannot be excluded until Brexit happens. Boris Johnson has three options to try and call a general election. Under the Fixed-term Parliaments Act 2011, an election may be called if it is agreed by two-thirds of the total number of MPs. Johnson presented motions for an election on 4 and 9 September and failed on both occasions when the majority of Labour MPs abstained. Johnson could try this again and potentially secure Labour backing, because the Benn act has removed the imminent possibility of a no-deal Brexit. This lowers the threshold of MPs needed to trigger a general election because it requires a simple majority to pass. This could work in Johnson’s favour. However, it is amendable, which can involve the moving of an election date to a time that works for the opposition. The leader of the opposition, Jeremy Corbyn, can call a no-confidence motion in the prime minister. This needs a simple majority to pass. He has been urged to do this by Johnson several times as a way of triggering an election, but Corbyn has resisted. It begins a 14-day period in which either the prime minister or someone else can try to form a new government. While Johnson could potentially lose this, and therefore his place as prime minister, to another Conservative, Corbyn could also struggle to get enough MPs to rally around him to form a government. The Scottish National party has said it would back him, but the Liberal Democrats have been extremely vocal in saying they would not support him. An election is triggered if, at the end of the two-week period, no alternative government has been formed. Kate Proctor Political correspondent Whether it is an election or a referendum campaign, the prime minister will champion himself as the man who wants to or has succeeded in his efforts to “get Brexit done”. The slogan might as well be written on the side of a bus. The day after departure, talks will enter a new phase as the UK seeks to strike a free-trade deal with the EU, as well as numerous other agreements on crime-fighting, foreign policy and data protection, to name a few. Almost immediately after the political trauma of exit, the UK will be plunged into a new cycle of deadlines and demands, countdowns and cliff-edges as it seeks to find a new place in the world.