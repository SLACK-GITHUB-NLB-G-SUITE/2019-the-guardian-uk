The French prime minister, Édouard Philippe, has promised a security review of staff working in counter-terrorism intelligence units after the state prosecutor said the police administrator who killed four people in an attack at a Paris headquarters adhered to “a radical vision of Islam”. Opposition politicians this weekend criticised the government for what they called serious failings, asking how a long-standing staff member working within a high-security police department was able to carry out a vicious, premeditated attack in his own office on Thursday. He left work to buy a kitchen knife and oyster knife and returned to kill four colleagues and injure two others, slitting the throat of at least one victim. The attack is being investigated as a terrorist incident. The attacker, Mickaël Harpon, who was shot dead at the scene, was a 45-year-old computer expert. He had worked in the police headquarters for more than 15 years and had high-grade security clearance for his job in a section of the police service dedicated to collecting information on jihadist radicalisation. The counter-terrorism prosecutor, Jean-François Ricard, said Harpon had converted to Islam several years ago and adhered to “a radical vision” of the religion. He said Harpon exchanged more than 30 religious text messages with his wife before leaving work to buy the knives, “displaying no nervousness”. Politicians on the left and right warned of security failings inside the police force and counter-terrorism intelligence, asking how the internal risk from a staff member was not spotted earlier. Many called on the interior minister, Christophe Castaner, to resign. Immediately after the attack on Thursday, Castaner had announced that the assailant had “never shown any behavioural problems” and never aroused the “slightest reason for alarm”. The case was initially handled as an ordinary homicide case, before analysis of the assailant’s phones led it to be passed to counter-terrorism police. But opposition parties accused the government of failings, saying Harpon had reportedly been mentioned to managers by a staff member four years ago when he appeared to have justified the 2015 attack on the satirical newspaper Charlie Hebdo, and that the government had initially seemed unaware of this. Castaner told French TV on Sunday that there had clearly been “failings” and they would be investigated. He said that in 2015, two of Harpon’s colleagues had mentioned to staff an altercation they had with him over the Charlie Hebdo attack but that those colleagues had not launched a formal procedure to put a complaint in writing. Philippe said procedures for detecting signs that anti-terrorism agents may themselves have been radicalised would be reviewed. He promised two internal reviews on security – one for the Paris unit where the attack took place and one for all intelligence units across the country. Philippe said: “It’s true there’s no such thing as zero risk, but it’s our responsibility to never accept any eventual failings and to always tighten the net”. He told Le Journal du Dimanche: “For all intelligence services, detecting internal threats is an absolute priority and no sign of radicalisation must go unnoticed or without response.” Philippe stood by Castaner, saying he gave him his full support. The Socialist lawmaker Sébastien Pietrasanta, who has sat on several parliamentary committees on counter-terrorism, said it was “not sufficient” to carry out internal reviews. He told France Info radio there was “a real state of dysfunction” inside counter-terrorism services if a radicalised staff member had full security clearance to the heart of sensitive operations. “There are serious questions to be answered,” he added. Christian Jacob of the centre-right opposition party Les Républicains said he would on Monday call for a full parliamentary inquiry into the “very serious” case. The counter-terrorism prosecutor on Saturday outlined how Harpon had carried out the attack, which killed three police officers and an administrator. He said Harpon had arrived for work at 8.58am on Thursday after taking the suburban train near his home in the north-west suburb of Gonesse. At 12.18pm he left the police complex near Notre Dame Cathedral and bought a metal kitchen knife with a 20cm blade and an oyster knife. The prosecutor, described how “in circumstances to be established … he mortally wounded with his knife, two victims who were getting ready to go to lunch”. He said the first victim, a 50-year-old, suffered a large wound to the neck, a second, 38, was fatally stabbed several times around the thorax and abdomen. “The autopsies carried out after these deaths show that it was a scene of extreme violence,” he added. “The attacker then went to another office on the same floor and stabbed a 37-year-old agent several times, two of them fatal. He then tried to go into another office, luckily closed, in which three police staff were having their lunch.” The attacker then took the stairs and stabbed a 39-year-old police officer, who died of their wounds. At the ground level he attacked a member of the administrative staff, leaving them with serious but non-fatal wounds to the neck. In the prefecture courtyard, he was challenged by a trainee police officer who tried to reason with him, telling him to drop his knife, and then shot him dead. “The total length of this killing spree is estimated at seven minutes,” Ricard said. In June, a parliamentary report on radicalisation within the public services spoke of 30 suspected cases out of the 150,000 police officers and 130,000 gendarmes in France.