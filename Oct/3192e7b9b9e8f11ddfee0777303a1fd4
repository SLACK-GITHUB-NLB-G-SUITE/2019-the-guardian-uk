Boris Johnson’s plan to fast-track his Brexit deal through parliament in time for next week’s 31 October deadline was blocked by MPs on Tuesday night, even after he threatened to pull it and press for a general election. The prime minister said he would speak to EU leaders and urge them not to agree to a prolonged Brexit extension after former Tory cabinet ministers Philip Hammond and Rory Stewart joined with Labour to inflict a humiliating defeat on the government. But the European council president, Donald Tusk, suggested almost immediately that he would recommend the EU27 accede to the UK’s request for a three-month delay. That request was set out in the letter reluctantly penned by the prime minister at the weekend in compliance with the backbench-led Benn act – despite his previous insistence that he would rather be “dead in a ditch” than countenance a delay. Following PM @BorisJohnson’s decision to pause the process of ratification of the Withdrawal Agreement, and in order to avoid a no-deal #Brexit, I will recommend the EU27 accept the UK request for an extension. For this I will propose a written procedure. The EU is expected to comply with the UK request for a three-month extension with the option to leave before 31 January if the deal is ratified earlier. After a day of cajoling and inducements from the prime minister and the Conservative whips, the government lost a crunch vote by 322 to 308 – a margin of 14. MPs rejected the “programme motion”, which set out a blistering three-day timetable for them to scrutinise the 110-page withdrawal agreement bill, despite having backed Johnson’s deal in principle by a majority of 30 in a separate vote just minutes earlier. The passage of the withdrawal agreement bill through parliament was automatically paused as a result of the defeat, with the Speaker, John Bercow, saying it was officially “in limbo”. Johnson told MPs: “We now face further uncertainty, and the EU must now make up their minds over how to respond to parliament’s request for a delay … One way or another, we will leave the EU with this deal.” The prime minister and his aides will have to decide whether to ask MPs to support an election – in line with his threat to MPs earlier in the day – or to draw up an alternative programme motion allowing more time for debate and continue to try to push his Brexit deal through parliament in the coming weeks. No 10 continued to strike a bellicose tone on Tuesday night despite Johnson’s refusal to repeat his election threat after the government’s defeat. A Downing Street source said: “Parliament and Corbyn have repeatedly voted for delay. On Saturday parliament asked for a delay until January and today parliament blew its last chance. If parliament’s delay is agreed by Brussels, then the only way the country can move on is with an election. This parliament is broken. The public will have to choose whether they want to get Brexit done with Boris or whether they want to spend 2020 having two referendums on Brexit and Scotland with Corbyn.” Johnson may be swayed to give more time for debate by the larger-than-expected majority of 30 the government won for the principle of his deal in the earlier vote. That appeared to signal there could be enough leeway for the government to succeed in passing the legislation, although some of the Labour MPs who supported it, including Gloria De Piero and Gareth Snell, said they could withdraw their backing at a later stage, if they were unable to amend it. Johnson said: “May I say how welcome it is, even joyful, that for the first time in this long saga this house has accepted its responsibilities, come together and embraced a deal … We should not overlook the significance of this moment.” MPs tabled a string of amendments, on issues including a customs union, environmental standards and avoiding the risk of a no-deal exit at the end of 2020. At least five pro-deal MPs have said they would support a customs union amendment tabled by a cross-party group of MPs including Ken Clarke and Ruth Smeeth. The Labour leader, Jeremy Corbyn, said: “We will seek a very clear commitment to a customs union, a strong single market relationship, hardwired commitments on workers’ rights, non-regression of environmental standards, and loopholes closed to avoid the threat of a no-deal Brexit once and for all.” After the government’s defeat, Corbyn urged the government to agree to an alternative timetable, to allow the legislation to continue to be debated. The rebellion against the programme motion was led by Hammond and Stewart. They were keen to secure reassurances that if the government had not succeeded in negotiating a free trade agreement with the EU27 by the end of 2020, the UK would not leave without a deal. Another potential rebel and former cabinet minister, David Gauke, was won over by a last-minute concession from the government on the issue. During six hours of debate in the Commons on Tuesday, Dominic Grieve, the former Tory attorney general, accused the prime minister of “bullying” tactics. Nick Thomas-Symonds, closing the debate for Labour, condemned “a flawed bill implementing a fundamentally bad deal” and said the timetable was far too brief. “This government, having tried unlawfully to shut down parliament altogether, now tries to shut down the ability of members to properly scrutinise the most important piece of legislation that’s been brought to this House for generations,” he said. “Weariness with the politics of the past three years is no good reason to wave through a bill of such huge significance in less than 36 hours.” Responding for the government, the justice secretary, Robert Buckland – a former remain supporter who said the 2016 referendum result had been “a bitter blow” – said the overwhelming message from voters was to “just get on with it”. He appealed to MPs to back the second reading and the programme motion, saying a Brexit date of 31 October was vital for keeping the trust of the EU. “The time for decision making is now,” he said. “The time for proposing nothing, opposing everything, and seeking to play old-fashioned politics is over.”