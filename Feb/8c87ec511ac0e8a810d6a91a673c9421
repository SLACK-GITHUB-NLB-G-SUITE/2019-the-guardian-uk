They left Baghuz in a convoy of trucks, slowly snaking across the desert as thin trails of black smoke from mortar strikes drifted into the sky behind them. The Islamic State fighters dangled their legs off the backs of vehicles normally used for transporting sheep. Brightly coloured keffiyehs wrapped around their faces, they stared at Kurdish troops as they passed without saying a word. After almost five years, the battle to dismantle Isis’ brutal “caliphate” is coming to an end in Baghuz, an unremarkable town on the Euphrates river deep in Syria’s eastern desert. Isis fighters had sneaked into an evacuation convoy of about 15 trucks, mostly carrying women and children, and were later identified and arrested at a screening checkpoint. At least some of the men were injured: one held an aluminium crutch on his lap. A handful of foreign faces could clearly be seen peering out from inside the trucks. UK, US and French special forces are preparing to help in storming the area once it is cleared of civilians and surrendering fighters, the Guardian understands, in a mission which it’s hoped will free hostages such as the British journalist John Cantlie, captured by Isis in Syria in 2012 and used as a propaganda tool. The two-week operation, which will mark the defeat of Isis as a land-holding force, has been repeatedly stalled as thousands of civilians have streamed out of the town. “Today around 1,000 people were rescued,” the SDF commander Adnan Afrin said. “It was a big surprise for us. We did not expect this many people were left.” The small town’s population has swollen in recent months as the SDF advanced along the Euphrates towards the Iraqi border, forcing Isis fighters to fall back from village after village to Baghuz, where they are now hemmed in by four separate fighting forces on both sides of the desert border. Commanders fear the tiny area still under Isis control is riddled with tunnels and laced with the IEDs and suicide vehicles that have turned the battles to reclaim cities under their control in the last few years, such as Mosul, into bloody street-by-street fighting. Since the operation began, an estimated 20,000 civilians and families of fighters have left Baghuz, many walking for three or four hours to reach the Western-backed SDF, a mostly Kurdish fighting force. Many reported that Isis had shot those attempting desertion as they fled the airstrikes and shelling. The evacuation convoy on Wednesday, however, as well as the presence of Isis fighters among the women and children, suggested the battle was finally moving into its endgame. SDF fighters held prisoner in the town were exchanged in return for food this week, another sign that Isis, low on supplies and ammunition, was finally weakening. On Tuesday, the SDF spokesman Mustafa Bali said a military operation to oust the extremists from Baghuz would be launched if those still in the town refused to surrender. The fleeing Isis men, believed to be mostly Iraqi and Syrian, hoped to blend in with the civilians, and eventually leave Kurdish displacement camps for Syria’s Idlib province, still in rebel hands, or to Anbar over the Iraqi border. The men who remain appear willing to fight to the death, and it is unclear how many women and children are with them, and whether they are there willingly or being held as human shields. The fate of Yusuf and Zahra Shikder, American children abducted by their mother and taken to Syria four years ago, is still unknown. They are believed to be with the few hundred fighters and diehard ideologues left. Most of the children lucky enough to escape smiled at the passing SDF convoys as they left the town on Wednesday; one small boy flashed a victory sign. They will be taken to an internment camp 200 miles away, where their fate is still far from certain. Several western governments have said their citizens fleeing the caliphate’s fall were not welcome at home; Isis families who fled other battles have been living in camps across Kurdish-held Syria for the last two years. The SDF insists it cannot house Isis fighters and their families long-term, and the timeframe for action is likely to be complicated when Donald Trump fulfils his pledge to pull US troops out of the area, a decision which will open a new chapter in Syria’s eight-year-old war. The Guardian saw a convoy of at least 60 empty trucks streaming past the Kurdish town of Hasekeh, which locals say come from Iraq with increasing frequency, and leave filled with US equipment to drive back over the border before the supposed April deadline for the drawdown.