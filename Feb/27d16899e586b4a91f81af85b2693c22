Congress overwhelmingly approved a border security agreement that would prevent a second painful government shutdown, as Donald Trump vowed to declare a national emergency to fund his long-promised border wall with Mexico. The House passed the spending package late Thursday night in a vote of 300-128, following the Senate’s approval in a vote of 83-16. The bill next goes to the president, who said he would sign it on Friday, and at the same time declare a national emergency. The border security compromise, tucked into a sweeping, 1,159-page spending bill, would appropriate $1.375bn for 55 miles of new fencing along the border with Mexico, which is far less than the $5.7bn Trump sought for a concrete or steel wall. A showdown over Trump’s demand for billions of dollars to build the wall, a key campaign promise, previously prompted the longest government shutdown in American history. The White House is confident a national emergency would allow Trump to circumvent Congress to tap funding for his wall that has been at the center of a fierce dispute with Democrats, who say such a barrier is expensive and ineffective. The proactive decision to declare a national emergency drew sharp condemnation from Democrats and threats of legal action while dividing Republicans, some of whom fear it sets a precedent for a future Democratic president to go around Congress. The House speaker, Nancy Pelosi, and the Senate minority leader, Chuck Schumer, said in a joint statement: “Declaring a national emergency would be a lawless act, a gross abuse of the power of the presidency and a desperate attempt to distract from the fact that President Trump broke his core promise to have Mexico pay for his wall.” Senator Susan Collins, a Republican from Maine, said Trump’s use of a state of emergency was of “dubious constitutionality” and would face challenges in court. Senator Marco Rubio, a Republican from Florida, said: “We have a crisis at our southern border, but no crisis justifies violating the constitution.” He warned that Trump was opening a door for a future president “to impose the Green New Deal”. But several Republicans said such an action was Trump’s only option. “For 20 years there’s been a bipartisan refusal on Capitol Hill by both big government Republicans and Ritz-Carlton Democrats … to enforce the immigration laws of this country or to change them,” said Senator John Kennedy, a Republican from Louisiana. “We need to face the issue and this is a start.” In order to avoid another shutdown, a bipartisan group of lawmakers solidified a compromise deal late Wednesday night to fully fund the government through the end of September. In the House, a handful of liberal members, including the freshman Democrats Alexandria Ocasio-Cortez, Rashida Tlaib, Ilhan Omar and Ayanna Pressley, opposed the measure, arguing that Trump’s “weaponization” of enforcement agencies “does not deserve an increase in funding”. On Capitol Hill, lawmakers were relieved to avoid another partial government shutdown, just weeks after a standoff over border security shuttered several federal agencies for 35 days and deprived 800,000 government employees of their paychecks. But Trump’s decision to declare a national emergency presented a new confrontation between Congress and the White House. “I think declaring a national emergency where there is no national emergency is not good for the president to do and not good precedent for future presidents,” said the House majority leader, Steny Hoyer. Meanwhile, Pelosi told reporters that she would consider a legal challenge to the declaration – something most observers say is inevitable and would probably be successful. “You want to talk about a national emergency – let’s talk about today,” Pelosi said, noting that it was the first anniversary of the massacre at Marjory Stoneman Douglas high school in Parkland, Florida, which claimed 17 lives. “That’s a national emergency. Why don’t you declare that emergency, Mr President?” And, confirming Republican fears, she said: “A Democratic president can declare emergencies as well.” Tensions had boiled ahead of the vote in the Republican-controlled Senate, as party leaders sought assurance from the White House that the president would sign the legislation. “Let’s all pray that the president will have wisdom to sign the bill so the government doesn’t shut down,” the Republican senator Chuck Grassley said after opening prayers on Thursday morning. Hours later, the majority leader, Mitch McConnell, suddenly appeared on the chamber floor and, interrupting Grassley, who was speaking at that moment, announced that Trump would sign the spending deal and declare a national emergency.