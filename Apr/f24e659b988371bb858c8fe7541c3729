It was an epic night, starting with a joke between Theresa May and Angela Merkel, involving nine hours of talks over a dinner of scallop salad, cod loin and macadamia nut parfait, and finishing with an extension and a warning to Britain from the European council leader, Donald Tusk: “Do not waste this time.” In the small hours of Thursday morning, the EU agreed with May to extend article 50 for a second time, delaying Brexit until 31 October. What happens until that deadline, said Tusk, will be in the hands of the UK. “This extension is as flexible as I expected, but a lot shorter than I expected, but it’s still enough to find the best possible solution. Please do not waste this time,” said Tusk. Catch up with all the events of the night here in Andrew Sparrow’s live blog. Not necessarily. It will be a “flextension”. After what Merkel described as “intense” discussions, it was agreed the UK still had three choices: it could ratify the existing withdrawal agreement and leave at any time between now and Halloween; it could revoke article 50 and remain in the bloc; or it could leave without a deal. But Tusk also made clear that the EU could extend article 50 again in October. Theresa May vowed to carry on to fight to get her withdrawal agreement over the line to avoid the need for elections to the European parliament. She said: “The choices we now face are stark and the timetable is clear.” The EU, including at the moment the UK, will vote for a new set of MEPs. The decision to hold European elections, which the prime minister had repeatedly said she was against, will come at some political cost for Theresa May. The extension carries a break clause. At the end of June, the EU27 want to be satisfied that the UK is meeting its obligations, including holding those European elections properly. They have also said they will not reopen the withdrawal agreement, but can discuss changes in the political declaration. The new date that the EU27 have agreed for the UK’s departure is Halloween. It is further away than May had hoped, and sooner than Donald Tusk had proposed, suggesting that Emmanuel Macron’s hardline tone won the day in the European council. At a press conference at 3am in Brussels she vowed to carry on to fight to get her withdrawal agreement over the line before 22 May to avoid the need for elections to the European parliament. She said: “The choices we now face are stark and the timetable is clear.” But the six-month extension is also perilous. It immediately puts her in the danger zone, allowing enough time for a leadership challenge, a general election and a second referendum. Yes. The EU will not reopen the withdrawal agreement but it can discuss changes in the political declaration. There will be a review at the end of June to take stock of progress. The UK must continue to be a member of the EU with “sincere cooperation” in the process and will remain a full member of the bloc with all voting rights. The sincere cooperation is not legally binding but Tusk warned that the UK “could not use any political blockings or tricks to be destructive or to stop our work”. Tusk dismissed Rees-Mogg’s warning that the UK should be “as difficult as possible” if it had to remain in the EU any longer, describing it as “nothing new”. Tusk said “the possibilities for the UK to block are very, very limited” because of the qualified majority voting system. No. The European commission president, Jean-Claude Juncker, insisted this would “not be another cliff-edge”. Tusk said: “June is not for decisions about the extension; the intention is not to discuss but to inform member states about the current situation.” The UK will also be required to hold elections if it is still in the EU on 22 May. The government must inform the Electoral Commission and the European parliament of its intentions to hold electionson 12 April. May hopes that even if new MEPs are voted in, they will not take up their seats when the new parliament convenes on 2 July if she can get her deal ratified before 30 June. Yes, but it took two rounds of talks after the French president, Emmanuel Macron, enraged fellow leaders by opposing a long extension, with only three states, including Belgium, showing any support. The majority, 17 member states, favoured a long extension until the end of December or March next year. Macron said the extension should be short enough to avoid any blocking of the EU renaissance project. Positive in the scheme of things. She even had a laugh with Merkel over a montage someone had created on Twitter of the two leaders preparing for a “Brexit-Krimi-nacht” or thriller night. #May und #Merkel zeitgleich in London und Berlin, bevor sie wieder gemeinsam in Brüssel eine Brexit-Krimi-Nacht durchmachen. @phoenix_de pic.twitter.com/aezOzrSKOo May emerged at 3am to tell reporters she was fighting to get much better reviews from fellow leaders than at previous summits. She spoke for an hour but a diplomatic dash the previous day to Berlin and Brussels had already convinced Merkel an extension was the right thing for the EU to grant, even though May appeared as far away as ever from ratifying the withdrawal agreement. These are still on the table, but the pressure is now off Labour to sign up to anything anytime soon, giving dangerous breathing space to May’s opponents. Expect fire and brimstone. Iain Duncan Smith has already called on May to stand down before the October Tory party conference to avoid further humiliation while the lifelong Brexiter Bill Cash has warned of a legal challenge to any further extension to article 50. On Thursday, the former Brexit secretary David Davis told BBC Radio 4’s Today programme it would “be very difficult for her” to be leader at the next Tory party conference in October. “If she does go, there will be a new leader and there will be a reset,” he said.