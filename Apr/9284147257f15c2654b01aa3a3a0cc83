A leaked EU document lays bare for the first time the differences in how British nationals will be treated by the bloc’s member states after a no-deal Brexit, with two countries emphasising that requests to stay could be rejected on public order and security grounds. The European commission paper presents a hotchpotch of attitudes among the EU27, Iceland, Norway, Lichtenstein and Switzerland, to the Britons living in their territory should the UK leave without a negotiated deal. Brussels has recommended in the event of a no-deal Brexit, UK nationals should not be considered to be staying illegally straight away but that contingency measures should be temporary with national migration policies returning “back to normal as soon as possible”. But the EU document, containing a full register of the countries’ policy positions, notes that “each member state will be faced with different challenges … In response, to this situation member states may choose the most appropriate options and procedures, subject to the compliance with union law. “Some member states (Austria, Denmark) remind that dangers to public order or security may be considered as grounds for refusal under national law,” the document says. Jean-Claude Juncker, the European commission president, has said the UK will crash out or face a long extension to its membership if the Commons fails to approve the withdrawal agreement by 12 April – next Friday. On Thursday, the commission’s vice president, Jyrki Katainen, a former prime minister of Finland, said: “Taking into account the limited number of days we have available, it’s logical that we’re ending up or rushing towards a hard Brexit. But hopefully I’m wrong.” Theresa May will present whatever deal she has reached with Jeremy Corbyn and parliament to the European Council, or ask for a lengthy extension. While she is not in favour of the extension, parliament is in the process of legislating to rule out no deal. If the UK parliament or government have significantly changed position, then a lengthy Article 50 extension may be required. EU leaders would decide how long, but there's no guarantee the EU27 would unanimously agree to this. If Theresa May's deal is not passed by parliament, then, with no other significant developments, this would be the date by international law that the UK leaves the EU without a deal. However she appears to have ruled out allowing this to happen. If Theresa May's new proposal does pass parliament and is approved by the European Council, then this could be the scheduled date of the UK's departure from the EU. Unless there is a further longer extension of article 50, the EU27 will vote for a new set of MEPs without the UK participating. However, if Brexit has been further delayed, the UK would hold European elections on the Thursday. If Theresa May's deal passes parliament, she is expected to stand down after the UK leaves the EU on 22 May, triggering a contest for the leadership of the Conservative party. There has been some suggestion though that she might hold out through the summer so that the contest takes place after the next Tory conference in October. With Theresa May and Jeremy Corbyn engaged in cross-party talks over a possible way forward, the EU’s chief negotiator, Michel Barnier, said: “We welcome the cross-party dialogue in the UK. It’s time for decisions.” According to the 34-page document obtained by the Guardian, the levels of preparedness and openness to UK nationals varies. The most generous countries – Denmark, Norway, Cyprus, Austria, Slovakia, Italy, Bulgaria, Malta, Croatia and Romania – will offer permanent national “regularisation” under which British citizens will automatically be considered to be legally staying. UK nationals already have an automatic right to reside in Ireland under the common travel agreement that covers the UK, Ireland, the Isle of Man, and the Channel Islands. Switzerland has concluded a bilateral agreement with the UK preserving the rights of citizens covering any scenario. Seventeen member states – Sweden, the Netherlands, Poland, Germany, Latvia, Spain, the Czech Republic, Estonia, France, Greece, Portugal, Luxembourg, Lithuania, Finland, Belgium, Hungary, Slovenia – have passed temporary national regularisation legislation under which British nationals will enjoy a grace period during which they will need to regularise their status under the countries’ migration laws. The length of the grace periods vary, with Belgium planning its “transition period till the end of 2020”, while Germany is currently providing a three-month period of the status quo, likely to be increased by a further six months, during which “citizens would need to apply for a residence status under 3rd country nationals regime”. The British government’s attitude to the 3.3 million EU nationals living in the UK is said to be a key factor in how some member states will treat UK citizens. “The Netherlands links its long-term solution (granting of a definite residence permit after a period of grace ending on 1 July 2020) to reciprocity,” the document says. “France, Poland and Belgium also insist on the importance of reciprocity as guiding principle.” The commission reports that most countries believe they will be able to “tackle the administrative challenges with existing resources” but that Lithuania and Spain have increased funding while Denmark, Norway and Estonia are “still considering whether they need to do so”.