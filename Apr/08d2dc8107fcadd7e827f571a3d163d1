If they want to leave, they should do it now, Jean-Claude Juncker fumed, to the emphatic agreement of the then European parliament president, Martin Schulz. It was 24 June 2016, and hours earlier, the British people had decided to leave the EU. The two men were holed up in an emergency meeting in the European commission president’s office in Brussels along with Donald Tusk, Juncker’s counterpart in the European council. The anger was “quite visible”, an EU source recalled. Global stock markets were tumbling. There was panic in the air. Tusk, though devastated by a result he had predicted, counselled for calm. Brussels had no choice but to wait it out for the formal two years of withdrawal talks to start, he argued. There would be no negotiation without Britain’s formal notification of the wish to leave. Even attempts by the government’s senior Brexit adviser, Olly Robbins, to speak to the EU’s most senior lawyers would be denied until the treaty exit mechanism, known as article 50, was triggered. Formal negotiations finally begin. A photograph of the two sides facing each other in which Britain sits without papers is used to criticise a lack of UK preparedness. The truth is that Barrow was about to take his notes out but civil service training kicked in as the photographers arrived.  Theresa May is left humiliated during a lunch with Jean-Claude Juncker in Brussels when Arlene Foster, the leader of the DUP, which provides May with a working majority in the Commons, pulls the plug on the agreement on citizens rights, the £39bn divorce bill and the Irish border.  A leaders’ summit in Salzburg turns sour as May's Chequers’ proposals for the future relationship are savaged as unworkable by the EU27.  The 585-page withdrawal document and a vague 26-page political declaration on the future relationship are formally agreed between the EU27 and the British government.  The EU27 sets a new deadline of 31 October 2019 for May to break the Brexit impasse at Westminster and ratify the withdrawal agreement after its emphatic rejection in three Commons votes. The clock, Tusk predicted, would be ticking more loudly on the other side of the Channel. Nearly three years on, and after the EU27’s decision last week to provide a new 31 October deadline for a Brexit deal, that reading surely remains as true today. While the EU is still waiting on Westminster, the story emerging over the past 34 months is of a union that was on the rocks over the migration crisis, which found itself, against all expectations, able to contrast EU unity to Westminster’s fraction and collapse, despite its own internal schisms and slip-ups along the way. But it was a nervy start. “People were understandably asking: ‘Does this mean that the union is about to break up’?” said an EU official. “What about my job? What about my kids?” At 6.33am BST on 24 June, even before the referendum result was formally confirmed, Tusk sent a “lines to take” memo to the EU’s capitals setting out the legal reality and the bloc’s strategic advantage under article 50. “We expect the UK to formulate its wishes when it comes to our future relationship,” he said. “Any agreement, which will be concluded with the UK as a third country, will have to reflect the interests of both sides and be balanced in terms of rights and obligations. First we need to agree the arrangements for the withdrawal of the UK.” At 11.23am BST, staff in Brussels received an email from the secretary general of the EU council, Jeppe Tranholm-Mikkelsen, seeking to assuage fears. “I know that many colleagues, in particular those who are British nationals, are very concerned today,” the Danish official wrote. “I would like you to know that, for me, all … colleagues are European Union officials, independently of the nationality.” A leaders’ summit was called for 29 June 2016 to rubber-stamp the newly minted opening principles, and a decision was made to meet again as an EU27 in Bratislava in September. “Which became an incredibly important moment,” said an EU official. “It was also a painful realisation that it is not just the UK that is a little bit strange, but maybe there is something we are doing wrong. There were some very difficult and honest discussions before Bratislava.” In the margins of a south-east Asia summit in Mongolia, Juncker and Tusk met the German chancellor, Angela Merkel, the then president of France, François Hollande, and the Dutch prime minister, Mark Rutte, for a fractious exchange. Merkel astounded the coterie of leaders by championing a digital single economy as the answer to populism. “Of course it is important but that is not what people care about,” said an EU source. Bratislava would instead be the start of an EU focus on illegal migration, globalisation and the threat of terrorism, the development of which has corresponded with a ticking up of EU credibility. The then Irish prime minister, Enda Kenny, insisted to Juncker that member states would keep a tight rein on the commission’s handling of Brexit. In Britain, May, who campaigned for remain, became prime minister on 12 July 2016, battling off the Vote Leave double bill of Boris Johnson and Michael Gove. “She was one of us,” said a diplomat. Tusk is understood to have since mused on whether a Johnson win would have avoided the torture of the past three years by pushing Brussels into telling the unvarnished truth to Westminster. But, for now, the new prime minister’s presence was reassuring. Then, in her conference speech to the party faithful, May declared her red lines of leaving the single market, customs union and jurisdiction of the European court of justice (ECJ). Avoiding a hard border on the island of Ireland became a looming issue. Nine months after the referendum, article 50 was finally triggered on 29 March with a letter delivered by the UK’s ambassador, Sir Tim Barrow. But a leaked account of a Downing Street dinner soon afterwards between Juncker, May and aides revealed how little the UK’s position had developed. May said she wanted to talk about a trade deal along with the withdrawal issues of the divorce bill, citizens’ rights and the Irish border. To Junker, fresh from persuading the Spanish not to make the future of Gibraltar one of the main withdrawal issues, it was an eyeopener. “It felt to the EU side like she does not live on planet Mars but rather in a galaxy very far away,” an official said. Juncker later encouraged the prime minister to hold a general election to strengthen her hand against those who would brook no compromise with Brussels. But after a disastrous campaign, the result only left May in the weakest of all positions: a minority government dependent on the Democratic Unionist party (DUP), which would come to torment No 10. “We have got a major problem,” Simon Case, the then director general of UK-EU relations at the British permanent representation to the EU, told colleagues. It was the autumn of 2017 and Case had returned to the British embassy from a meeting at the European commission with Sabine Weyand, the no-nonsense German trade expert, chosen as deputy to the EU’s chief negotiator, Michel Barnier. The Frenchman’s odd title was borne out of the commission’s desire to give him precedence over the other EU institutions after an early territorial spat. Weyand had outlined to Case the commission’s backstop plan for Northern Ireland to avoid a hard border. To British eyes, and those of the DUP, it created a border down the Irish sea by keeping Northern Ireland alone in the EU’s customs territory and under large swathes of single-market legislation. The scene was set for a stormy meeting with the new Irish prime minister, Leo Varadkar, at a summit in Gothenburg in November 2017. May argued the Irish border had to be solved by a future trade deal. The Irish would not allow discussions on that before “sufficient progress” was made on an all-weather guarantee of no hard border. “We want that written down in practical terms,” Varadkar said. The UK had agreed to a £39bn divorce bill and a role for the ECJ in protecting rights of EU citizens in the UK, despite an at times bad-tempered negotiation. Barnier reacted to British briefings to the press by refusing to offer sight of statements before they were issued. The UK negotiators enjoyed tormenting their EU counterparts in a very British way. With phones and laptops banned in the negotiating room, a UK official would deliver updates on the cricket score in the South Africa-England test series in concealed papers. The British negotiators would react gnomically for the benefit of their nonplussed EU counterparts on the other side of the table to what looked like bombshell Downing Street missives. Agreements were nevertheless found on two of the three main issues. Just the Irish border remained an intractable puzzle. An attempted compromise came crashing down on 5 December when May came to Brussels to sign off on a joint report committing the UK to ensuring “continued regulatory alignment” between Northern Ireland and the EU, should there be no alternative plan. Over lunch with Juncker, May received three separate notes from aides informing her that the DUP’s leader, Arlene Foster, would not accept the deal. Juncker told May he would return to his office to give her time. Hours went by but it could not be salvaged. May returned to London humiliated. “From then on, the DUP knew they could play with her,” said an EU source. Sufficient progress was finally achieved a few days later with the addition of paragraph 50 to the joint report in which the UK vowed to avoid regulatory barriers with Northern Ireland. “But it was pure fudge,” said an EU negotiator. “Then we waited for the UK to deliver a plan to make to make this Northern Ireland fudge work – maybe a future customs union – and there was nothing.” The EU sought to push the British side into action through publishing in February 2018, without prior sight, a draft protocol putting into legal text its plan for Northern Ireland. The UK soon after moved towards a model in which the UK would in effect be in a customs union with the EU as a “bridge” to something vague but more ambitious. Flesh on the bones was provided on 12 July with the “Chequers plan” for the future relationship. The economic section was regarded as a catastrophe on the EU side. It involved creating an internal market for goods only, “which was cherrypicking”, and “magical thinking” on customs arrangements that opened the door to fraud. EU leaders conspired with May, in a series of calls, to avoid publicly trashing Chequers until the prime minister’s party conference speech. Tusk blocked the distribution of a highly critical Barnier presentation. But then there was Salzburg. Flying into the Austrian city at the foot of the Alps in a Belgian air force jet on 19 September 2018, Tusk turned to his aides. This is something else, he said. This will create problems. Tusk was reading an article written by the British prime minister that was due to be published in the German daily newspaper, Die Welt. May had savaged Barnier’s approach, accusing the EU of demanding the unacceptable. At an opening summit dinner, May repeated her pitch in a speech. “The feeling was that she didn’t want to respect the tacit agreement on Chequers,” said an EU source. The following day, the French president, Emmanuel Macron, led the charge. Chequers was not acceptable, he said, while in private ruling out a plan to take part in some theatre at the next summit in which May would negotiate with the EU27. “No, never,” he insisted, adding that Barnier was its negotiator. Worse was to come. In the morning, Barrow had brought out a cake to a group of leaders, including May. The commission’s secretary general, Martin Selmayr, took a raspberry, prompting accusations of cherrypicking – and laughter. A Tusk aide took a picture. It was posted on Instagram. “A piece of cake, perhaps? Sorry, no cherries,” read the caption. With relations soured, the European council president was accused in the media, to his horror, of mocking the diabetic British prime minister. It was eventually courtesy of the EU budging on the Irish backstop, allowing it to contain a EU-UK customs territory, that a deal was reached in 25 November 2018. The concept was deeply uncomfortable to many. France threatened to block it. But May told the leaders it was necessary to get her deal passed by the House of Commons – only to subsequently drop plans to hold a vote in December as it became clear a rump of Conservative MPs would not accept a potentially indefinite customs union. A cowed prime minister was left asking for more assurances on the backstop’s temporary duration. “What guarantee is there that this will pass if we do,” asked Luxembourg’s leader, Xavier Bettel, at a December summit. No answer came. “The leaders had lost faith in her judgment,” said an official. The deal has since been defeated by 230 votes, 149 and 58. And the EU is still waiting for Brexit.