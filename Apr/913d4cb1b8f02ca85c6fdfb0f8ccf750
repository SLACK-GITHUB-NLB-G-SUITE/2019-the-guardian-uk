Anne-Marie Duff’s last appearance at the Donmar was as a love-stricken Palestinian queen in Racine’s Berenice. Now she plays the rather different Charity Hope Valentine, whose heart is said to be like a hotel, “guys checking in and out all the time”. But Duff seems just as much at home in a spirited Broadway musical – with a score by Cy Coleman, lyrics by Dorothy Fields and a book by Neil Simon – as she was in a French tragedy. The show itself dates from 1966 but is enjoying a surge in popularity – with recent revivals in Nottingham, Manchester and at the Watermill Newbury – and it is not hard to see why. There is something cheering about the cockeyed optimism of Charity, who seeks to escape her grim life as a New York taxi dancer where all you do is “defend yourself to music”, and Coleman’s score brims with good tunes. Josie Rourke – in her farewell production at the Donmar – treats the show as a hymn to female resilience and gives it a strong visual style. Robert Jones’s silvery design takes its inspiration from Andy Warhol’s Factory, which means a nightclub is populated by blond-mopped Warhol lookalikes and a vision of suburban bliss is achieved through unfolding Brillo Pad boxes which, like Russian dolls, become ever more diminutive. The difficulty with this show lies in finding an alternative to Bob Fosse’s original dance style, but Wayne McGregor’s choreography does that with great elan: in Big Spender, he has the dancers draped over a set of ladders, using their bodies to taunt their despised customers. But much of the evening’s success derives from Duff, who radiates joy in the big numbers, flicking the audience with a silken banner in I’m a Brass Band, while suggesting that Charity’s happiness is sometimes hard won. It is an exhilarating performance supported by Arthur Darvill as Charity’s unstrung beau, Lizzy Connolly and Debbie Kurup as her supportive chums and Adrian Lester – in a role filled by a succession of starry guests – as a religious hipster. The show may be pre-feminist but, in Rourke’s hands, it has the rhythm of life. At Donmar Warehouse, London, until 8 June.