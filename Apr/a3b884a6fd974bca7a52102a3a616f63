A cross-party group of MPs has forced through an emergency bill in less than six hours to instruct Theresa May to seek an extension to article 50 and avoid a no-deal Brexit, despite government opposition.The bill, spearheaded by Labour’s Yvette Cooper and the Conservative Sir Oliver Letwin, passed late into the night, with MPs defeating a number of obstructive amendments from both Brexiters and the government. It finally passed its third reading about half an hour before midnight by just one vote – 313 ayes to 312 noes – and must now pass the House of Lords. The bill was almost scuppered during a frenzied day in parliament after MPs initially voted by a majority of just one – 312 to 311 – to let the snap bill proceed.Cooper and Letwin then had six hours to pass the bill’s second reading, committee stage and third reading through the House of Commons. Minutes before the narrow first vote, an amendment from Labour’s Hilary Benn to grant more time was blocked in extraordinary circumstances, as the Speaker, John Bercow, was forced to make the casting vote after a tied result in the Commons. Benn’s amendment, which would have given MPs control over the order paper on Monday to hold further indicative votes, fell after MPs’ votes were tied with 310 each way. Bercow said it was precedent for the Speaker to vote with the government, which had opposed the motion and the amendments. “In accordance with precedent and on the principle that important decisions should not be taken except by majority, I cast my vote with the noes,” he said. “That is the proper way in which to proceed.” The Speaker said the situation had not occurred since 1993, a vote that had involved the Maastricht treaty bill. The government opposed both the Cooper-Letwin motion and Benn’s amendment. The Commons leader, Andrea Leadsom, argued earlier in the debate that the government had already said it would request a short extension. Speaking in the debate, Letwin said the government’s plan to seek an extension was an “enormously welcome development” and he did not have doubts that they would seek to avoid a no-deal Brexit, but there was still a need to pass legislation. The veteran Brexiter Bill Cash called the bill “reprehensible” and said it would set a terrible precedent for the government to rush through legislation in a single day. “This is something profoundly undemocratic,” he said. Cooper said the bill would deliberately not specify the length of an extension. “It should be for the prime minister to put a proposal forward,” she said. “It is right she puts that forward, and then the house will decide.” Labour and the SNP whipped in support of the motion. MPs voted through the second stage of the bill at 7pm and after voting on a long series of amendments passed it around 11.30pm. During the marathon session of late night votes, 91 Conservative MPs rebelled against a government amendment which would have allowed the Brexit secretary to agree an extension date without needing parliament’s approval. Dozens of Tory Brexiters opposed the amendment, suggesting Eurosceptics wanted to reserve the right to vote down a long extension. The newly passed legislation could be debated in the Lords as soon as Friday or Monday, where it is likely to encounter attempts to frustrate its progress by Eurosceptic peers. However, Labour sources in the Lords said supportive peers were preparing to stay up all night to insure against any attempts to filibuster the legislation.