For the first time in his 16 years in office, Turkey’s president, Recep Tayyip Erdoğan, has been punished at the ballot box as his ruling Justice and Development party (AKP) lost control of the capital, Ankara, in fiercely fought local elections. In a further potential blow, claims of an AKP victory in Istanbul, Turkey’s largest city and commercial centre, were challenged by the opposition. The AKP’s loss in Ankara to the secular People’s Republican Party (CHP) mayoral candidate, Mansur Yavaş, ended 25 years of the Islamist party’s dominance over the capital and sent shockwaves throughout the rest of the country. In Istanbul, the main opposition bloc candidate, Ekrem İmamoğlu, said in the early hours of Monday that he had won by nearly 28,000 votes over the AKP candidate and former prime minister, Binali Yıldırım. But minutes later, the AKP provincial head in Istanbul said Yıldırım had won by about 4,000 votes. What should have been routine municipality elections morphed into a referendum on Erdoğan’s decade and a half in office as economic woes began to bite into his support. Erdoğan’s leadership has been marked by consistently strong economic growth, but last year’s currency crisis triggered an official recession last month. Inflation is hovering at about 20%, sending the cost of living soaring for working-class AKP voters. Although the president was not on the ballot, he had campaigned tirelessly in an attempt to draw attention away from the economy. He framed the local elections as a matter of “national survival”, accusing opposition parties of links to terrorism and blaming inflation on foreign powers seeking to undermine the country. More than 57 million voters were eligible to take part in choosing the mayors of 30 major cities, 51 provincial capitals and 922 districts. In big cities, voters cast ballots for a metropolitan mayor, a district mayor, the municipal assembly and a neighbourhood administrator. Opposition hopes that dissatisfaction at inflation and rising unemployment would be enough to dissuade working-class AKP voters from turning up to vote appeared to be well-founded. AKP took nearly 45% of the votes after 90% of the more than 194,000 ballot boxes were counted, according to the state broadcaster TRT. The secular main opposition party, CHP, had 30% overall. The pro-Kurdish People’s Democratic party (HDP) regained several seats across the mainly Kurdish south-east, where the government has replaced elected mayors with government-appointed trustees in the past after alleging the ousted officials had links to the outlawed militant Kurdistan Workers’ party (PKK). It lost control of two cities where government security services have been posted to the AKP. “Every gain and every loss is the will of our people and also a requirement of democracy that should be acknowledged,” Erdoğan said in Istanbul before flying to Ankara on Monday night. “We will admit we won the hearts of our people in areas that we won and we will admit we were not successful enough in areas we lost.” The elections were marked by scattered episodes of violence. At least four people were killed in south and east Turkey and dozens injured in election-related clashes in the Kurdish-majority city Diyarbakir. In Istanbul, police said one person was stabbed in a 15-person brawl that broke out between candidates in Kadıköy district. The elections were the first ballot-box test for Erdoğan since he was re-elected last year under a new system of government that gave the presidency expanded powers. Government critics have said the elections were not fought fairly, with several HDP leaders in the south-east arrested on terrorism charges in the runup to voting day. Largely pro-government media coverage also put opposition parties at a campaigning disadvantage.