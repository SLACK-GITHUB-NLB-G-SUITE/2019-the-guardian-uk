Britain will remain as a member state of the EU until 31 October, with the option to leave earlier if Theresa May can secure Commons support for the Brexit deal, after a Franco-German carve-up of the UK’s future. A marathon six-hour debate among the EU leaders concluded with the prime minister being offered a longer extension than she had sought but providing a new Halloween no deal cliff-edge to focus minds in Westminster. “This extension is as flexible as I expected and a little bit shorter than I expected but it is still enough to find the best possible solution,” the European council president, Donald Tusk, told a media conference that began after 2am local time. He said of the extra six months of EU membership: “Please do not waste this time.” The EU would also hold a symbolic June summit to review the UK’s behaviour as a member state following an outspoken intervention by the French president, Emmanuel Macron, about the need to avoid a “rogue” Britain undermining the European project. Speaking afterwards, Theresa May repeatedly ducked questions about her future as prime minister, after having previously said she would not accept an extension beyond 30 June. She simply insisted that the UK “can still leave on May 22 and not hold those European parliamentary elections” if parliament passes the withdrawal deal. May also once again blamed MPs for being the cause of public frustration over the failure to implement Brexit. Asked whether she should apologise for the UK still being in the EU, she said: “Over the last three months I have voted three times to leave the European Union. If sufficient members of parliament had voted with me in January we would already be out of the European Union.” The prime minister will now head back to London to give a statement in the House of Commons in the early afternoon. During the day Macron had sought to maintain the pressure on Britain to act with an “enhanced duty of sincere cooperation” during the extra period of membership following the threats from Brexiters, including Jacob Rees-Mogg MP, that the UK could seek to disrupt the bloc from within. The June summit will be an opportunity to “take stock” but it is not a cliff-edge, Jean-Claude Juncker said. After the new date was announced, Macron said leaders had found “the best possible compromise” because 31 October preserved EU unity, allowed the British more time and preserved “the good functioning of the European Union”. The autumn deadline provides an opportunity for the EU to bring Brexit to an end before the conclusion of Juncker’s tenure as European commission president on 1 November. British MEPs would need to be elected on the 23 May if the Commons does not pass the withdrawal agreement by then, or otherwise leave by 1 June. Tusk, who had proposed a full year extension to allow Westminster to break the impasse, said he could not discount the leaders having to deal with a further extension request in October. “I think it is always better to have a piece of something than all of nothing. Six months, more than six months, it could be enough for a good solution if there is a good will and majority for a good solution in the House of Commons.” Tusk added that “maybe we are not happy but satisfied”, adding that the extra time opened a further opportunity for Britain to “revoke article 50 and cancel Brexit altogether”. Juncker admitted that the long debate among the EU27 had been a “bit difficult” but joked that he liked the deal as his time a commission president would end at midnight on 31 October and he might have to leave a debate about a further extension early. The prime minister of Malta, Joseph Muscat, tweeted: “A Brexit extension until 31 October is sensible since it gives time to UK to finally choose its way. The review in June will allow [European council] to take stock of the situation.” The compromise autumn date was carved out after the EU’s Franco-German engine found itself divided over how to deal with Britain’s political crisis. A senior EU source described it as “26 to one”. The German chancellor, Angela Merkel, had clashed with Macron, both over Berlin’s insistence that May’s government can be trusted, and that a no-deal scenario should not be risked by offering up only a short delay such as one ending on 30 June, as requested by the British prime minister. Merkel argued that a short delay would not offer any prospect of the impasse in Westminster being broken and the delay should instead end on 31 December. She had claimed that the biggest incentive for Conservative MPs to back the deal lay in the threat of having to hold European elections due to a failure to complete Brexit. But Macron warned against such a long extension, arguing that a no-deal threat should remain and that there were insufficient guarantees that the British government would act as a responsible member state. Sources suggested Paris had “gone in hard”, and forced EU capitals towards the shorter date. The French president also insisted on the redrafting of the EU’s summit communique, writing in that the UK – during any extra time as a member state – would have to “refrain from any measure which could jeopardise the attainment of the union’s objectives, in particular when participating in the decision-making processes of the union”, according to a leak obtained by the Guardian. The EU27 also emphasised their right to meet without the UK on key long-term decisions. The differences between Paris and Berlin had been evident earlier in the day when Merkel told the Bundestag that May was likely to get a longer extension than she needed, while Macron told reporters on arrival at the summit that “nothing had been decided”, dismissing talk of a long extension as rumours. Macron insisted on clarity from May about what Britain wants, warning: “Nothing should compromise the European project.” The Guardian understands that May had not pushed back against the suggestion of a long extension in her one-hour address to the other 27 leaders before their debate, instead insisting that her priority was to be able to leave once the withdrawal agreement was approved. The prime minister also asked the leaders to avoid a situation in which she would have to return to Brussels to ask for a further extension. As EU leaders had gathered to discuss an extension to article 50 of about nine months, May publicly dropped her promise not to allow a delay to Brexit beyond 30 June while she was prime minister. Sources said she would abide by her decision to step down only once a Brexit deal with the EU had been passed by parliament, meaning she looks likely to stay on and keep trying to push through a withdrawal agreement for as long as it takes. Arriving at the talks, May signalled she would accept a much longer delay from EU leaders – expected to be nine to 12 months – as long as there was a “break clause” allowing the UK to leave as soon as MPs approve a deal with a meaningful vote. “What matters, I think, is I have asked for an extension to 30 June but what is important is that any extension enables us to leave at the point at which we ratify a withdrawal agreement. So we could leave on 22 May and start to build our brighter future,” she said. The six-month extension is politically explosive for May because she had promised that “as prime minister” she would not countenance any delay beyond June 30 that would involve the UK having to take part in European elections. Eurosceptics will also be furious that six months is not enough timeto replace her as Conservative leader and use the remaining extension for a “reset” of Brexit strategy – through an attempt at fresh negotiations or gaining parliamentary backing for a no-deal exit through a general election. In contrast, it would be enough time for May to negotiate a softer Brexit compromise either with Labour or parliament more widely involving a customs union or even a second referendum. The Guardian understands that the Conservative party rules that protect May from a leadership challenge until 12 December had been a motivating factor in the offer of a lengthy Brexit delay.