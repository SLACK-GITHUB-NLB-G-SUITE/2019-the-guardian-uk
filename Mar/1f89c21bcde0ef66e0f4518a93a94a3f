Brexit is set to be delayed by at least three months, after parliament opted overwhelmingly to request an extension to article 50 on another day of divisive votes that exposed the split in Theresa May’s fractured cabinet. The prime minister is now expected to bring her twice-defeated Brexit deal back to parliament on Tuesday, after she narrowly retained control of the next steps of the process. The votes, the last in a series of vital parliamentary decisions on Brexit over several days, mean that Britain’s departure from the EU should not now take place before 30 June and gave the prime minister a window to resuscitate her plan. But May’s cabinet splintered yet again and eight cabinet ministers, including the Brexit secretary, Steve Barclay, and leader of the house, Andrea Leadsom, voted against the government’s motion extending article 50, preferring to keep the threat of no deal in place. In total, more than half of Tory MPs voted against the motion. Barclay wound up the debate for the government, saying: “It is time for this house to act in the national interest, it’s time to put forward an extension that is realistic” – before trooping through the no lobby to reject that argument. Government sources insisted he was not intending to resign, despite his unprecedented action. The shadow Brexit secretary, Keir Starmer, said: “This evening the Brexit secretary voted against his government’s own motion on Brexit, which earlier in the day he had defended in the House of Commons. That’s the equivalent of the chancellor voting against his own budget. This is a government that has completely lost control.” Labour’s divisions over Brexit were also clearly on display, however. The party whipped its MPs to abstain on an amendment calling for a second referendum – but 24 Labour MPs defied the whips to vote for it; and 17 rebelled to vote against, including several frontbenchers. Stoke-on-Trent North MP Ruth Smeeth resigned as the parliamentary private secretary to Labour’s deputy leader, Tom Watson, after voting against a referendum. “This was a really difficult decision to make, but I made a promise to my constituents that I would not consider a people’s vote, and I can’t just pretend this vote is not happening. I need to consider the views of my constituents and vote against the people’s vote,” she told her local paper, the Stoke Sentinel. Junior shadow ministers Yvonne Fovargue, Emma Lewell-Buck, Justin Madders, and Stephanie Peacock also voted against the second referendum amendment. All were reportedly asked to resign by Jeremy Corbyn’s office following the vote and it was announced that they had stepped down on Thursday night. The amendment, tabled by former Tory Sarah Wollaston, now of the Independent Group, and signed by around 30 MPs, was voted down by 85 votes to 334. The official People’s Vote campaign had urged MPs not to support the amendment, arguing it was not yet the time to press the case. But TIG’s Anna Soubry criticised Labour for declining to support the amendment, saying: “This is a betrayal of Labour party members and voters, Labour MPs, Labour’s conference policy and, most importantly, the British public. The Labour party leadership are determined to deliver Brexit, which would harm our country.” Asked about whether Conservative MPs who voted against the government’s motion would be disciplined, May’s spokesman said it was clear it was a free vote on Thursday night; but that cabinet ministers who voted against the government motion would now be expected to follow government policy. “The government’s motion won with a substantial majority, one in the name of the prime minister,” the spokesman said. “It was a free vote and people were free to exercise their votes as they so choose. But the cabinet is united around allowing the UK to leave the EU with a deal and we need to get on and deliver that,” he said. Asked if cabinet ministers were now bound by the government’s position to extend article 50, which was passed overwhelmingly by 413 votes to 202, a No 10 spokesman said: “Yes, that is how collective responsibility works.” The past few days have seen an extraordinary collapse in Tory discipline, with four ex-remainer cabinet ministers abstaining on a whipped vote on Wednesday night, and May forced to offer a free vote on Thursday’s motion to delay Brexit. The prime minister has consistently emphasised the importance of keeping the threat of a no-deal Brexit on the table, to avoid weakening Britain’s negotiating hand. But a group of her own ministers threatened to resign en masse if she refused to offer them a vote on requesting to extend article 50. The government’s motion said that if May’s plan is approved by next Wednesday, the government will request a brief extension until 30 June, to give parliament time to pass the legislation needed to leave the EU. Government sources indicated another meaningful vote is likely to be held on Tuesday 19 March, with Downing Street working intensively to win over the Democratic Unionist party and the Brexit-backing European Research Group. If the deal does not pass on Tuesday, May would be likely to set out her request for a longer extension before the European council summit on Thursday. Downing Street said the blame for delay lay with parliament and was against the prime minister’s will. “The prime minister absolutely wanted and strived for the UK to be leaving the EU on 29 March. Everything she has done since entered office was intended to deliver that,” the spokesman said. “Now we have to confront the difficult decision that decisions taken by parliament have left us in.” Earlier, MPs narrowly passed up a chance to seize control of the Brexit process through a series of indicative votes in the Commons, defeating by 312 votes to 314 an amendment tabled by the Labour MPs Hilary Benn and Yvette Cooper, and former Conservative minister Oliver Letwin. The amendment called for steps to “enable the House of Commons to find a way forward that can command majority support” after Theresa May’s Brexit plan was rejected for a second time on Tuesday. The Labour leader, Jeremy Corbyn, said: “After the last few days of government chaos and some defeats, all of us now have the opportunity and the responsibility to work together to find a solution to the crisis facing this country, where the government has so dramatically failed to do so. “We have begun to hold meetings with members across the house to find a consensus and a compromise that meets the needs of our country.” There is no EU consensus over how to handle a request for an extension. Before the Commons latest votes, the European council president, Donald Tusk, expressed his backing for an extension beyond the three months that May is initially seeking. “During my consultations ahead of [the leaders’ summit next week], I will appeal to the EU27 to be open to a long extension if the UK finds it necessary to rethink its Brexit strategy and build consensus around it,” Tusk tweeted.