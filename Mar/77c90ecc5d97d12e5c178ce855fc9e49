Theresa May will attempt one final desperate roll of the dice on her Brexit deal, issuing a stark warning to mutinous Brexiters that they must approve her offer by next week or face a long article 50 extension. The prime minister was humiliated yet again amid chaotic scenes on Wednesday night in parliament, as her cabinet ruptured three ways and MPs inflicted two more defeats on the government to demand no deal should be taken off the table permanently. In an unprecedented night of Tory splits, four cabinet ministers, Amber Rudd, David Mundell, David Gauke and Greg Clark, defied their party’s last-minute whip and refused to vote against the government’s own motion, after it was amended to rule out any prospect of no-deal Brexit. 7pm Caroline Spelman declines to move her amendment aimed at taking a no-deal Brexit off the table for good - but Yvette Cooper, one of the other signatories, moves it instead. 7.16pm MPs back the amendment by 312 votes to 308, defeating the government. 7.21pm Word gets out that the government now plans to whip against its main no-deal motion because it has been amended to rule out no-deal in all circumstances. Rumours begin to fly of ministers being ready to resign to defy the whip. 7.33pm MPs reject the Malthouse compromise - an amendment in favour of a managed no-deal Brexit - by 374 votes to 164. 7.42pm Tory whips attempt to force MPs to vote against the amended motion they had effectively already backed. A number of cabinet ministers now reported to be abstaining. 7.49pm May is defeated again - with the margin of loss increasing from four to 43. 7.55pm May tells MPs that if they do not back a deal soon she will have to seek a long article 50 extension. 8.01pm Names emerge of government ministers - including Amber Rudd and David Gauke - who abstained on the vote, amid continuing rumours that they could be forced to resign. 8.09pm Sarah Newton, a junior pensions minister, resigns after defying the whip to vote against the government. Six other cabinet ministers also splintered to back a separate proposal for a “managed no deal”, despite the prime minister’s warning that the plan was doomed. After her defeat, May signalled she would gamble one last time on forcing through her Brexit deal, bringing forward a motion on Thursday on delaying Brexit which would “set out the fundamental choice facing this house”. If MPs agreed a deal, she said, the government would request a “short, technical extension” to article 50, a hint that May plans a third meaningful vote next week. Without an agreed deal, she said, there would be a “much longer extension” that would require the UK to take part in European parliament elections. “I do not think that would be the right outcome,” May said. In a defiant reply, Steve Baker, the vice-chair of the European Research Group of hard Brexiters, said rebel Eurosceptics would not be cowed. “I’ll say to the government now, when meaningful vote three comes back I will see to it that we keep voting this down however many times it’s brought back. “Whatever pressure we’re put under and come what may, please don’t do it, keep going back to the EU and say: ‘It won’t pass.’” Other Tory rebels sounded far less certain. Simon Clarke said there was “a gun to my head at this point” and suggested he could back the deal next time. “I think voters will appreciate we have a very, very limited range of options left if we want to actually honour the manifesto commitment to leave at all. Now it’s effectively a bad Brexit deal or no Brexit at all, which is absolutely ghastly.” The prime minister’s warning of an extended Brexit delay followed a disastrous night in parliament for the government. MPs amended May’s motion ruling out no deal on 29 March to a much more radical proposition, ruling out no deal altogether. That amendment, originally proposed by the Tory backbencher Caroline Spelman but brought to a vote by Labour’s Yvette Cooper, passed by four votes. After a frantic conference on the floor of the Commons, panicking whips demanded that Tory MPs now vote against the government’s own amended motion – but were still resoundingly defeated by a majority of 43. The minister for disabled people, Sarah Newton, resigned from the Department for Work and Pensions in order to vote in favour of the amended motion and a slew of other ministers also abstained, including the energy minister Claire Perry, solicitor general Robert Buckland, defence minister Tobias Ellwood, business minister Richard Harrington, digital minister Margot James and foreign minister Alistair Burt. Sources close to the abstaining ministers claimed they had been given the nod to skip the vote. It was indicated by sources on Wednesday night that cabinet ministers who abstained did not intend to resign and Downing Street said they would not be pushed. Mundell, the Scotland secretary, said he could not in conscience have opposed the amendment. “I’ve always opposed a no-deal Brexit. The house made its view clear by agreeing the Spelman amendment. I didn’t think it was right for me to oppose that,” he said. “The PM has my full support in her objective of leaving the EU with a deal to deliver an orderly Brexit.” Remainer cabinet ministers urged their colleagues not to back Spelman’s amendment, believing a thumping victory for the government motion would send a strong signal to Eurosceptics. An alarmed Spelman then attempted to withdraw her amendment but was barred by the Speaker, John Bercow, who said the amendment could be moved by other supportive MPs. Cooper moved the amendment instead and the government was defeated by four votes. The vote does not definitively preclude a no-deal Brexit – MPs must still agree a deal, or extend or revoke article 50 in order to do that – but it underlined both the strength of feeling at Westminster and the government’s loss of control. May’s warning about a potentially lengthy delay to Brexit came as it emerged the DUP is back in talks with senior government figures about what it would take for them to back May’s deal at a third Commons vote. A party source said “channels are open”. Jacob Rees-Mogg told the Guardian’s Today in Focus that his opposition to the government deal was “not a cunning plan to get us to no deal by default” and said he could vote for the deal if it was backed by the DUP. Discussions are taking place around a point that Rees-Mogg, the ERG chair, raised in the House of Commons before Tuesday’s vote, relating to “how article 62 of the Vienna convention could be used”. Stephen Barclay, the Brexit secretary, replied that the UK would have the ability to terminate the withdrawal agreement “if the facts clearly warranted that there had been an unforeseen and fundamental change of circumstances”. An ERG source said this had been written by the attorney general, Geoffrey Cox, but had not made it into his final legal advice on Tuesday. “If we’d had it earlier in the day it could have changed the vote,” the source said. Earlier on Wednesday night, May was also forced to allow a free vote on an amendment by Tory backbenchers based on the so-called Malthouse compromise, which suggested a 21-month transition to no deal. The amendment was comfortably defeated by Conservative MPs and opposition parties, 374 votes to 164, but the vote drove an even deeper wedge into May’s fracturing cabinet. Six cabinet ministers voted in favour of the proposal: Gavin Williamson, Jeremy Hunt, Penny Mordaunt, Andrea Leadsom, Sajid Javid and Alun Cairns – many of them tipped as future leadership candidates. In the aftermath of the vote, Brussels warned that the Commons vote blocking a no-deal Brexit was meaningless. A senior EU negotiator described it as “the Titanic voting for the iceberg to get out of the way”. A commission spokesman said it was “not enough to vote against no deal – you have to agree to a deal … We have agreed a deal with the prime minister and the EU is ready to sign it.”